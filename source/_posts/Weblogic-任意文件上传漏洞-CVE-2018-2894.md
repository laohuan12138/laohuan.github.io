---
title: Weblogic 任意文件上传漏洞(CVE-2018-2894)
date: 2020-07-02 21:28:15
categories: 漏洞复现
tags: Weblogic
---

#### 背景

Oracle 7月更新中，修复了Weblogic Web Service Test Page中一处任意文件上传漏洞，Web Service Test Page 在“生产模式”下默认不开启，所以该漏洞有一定限制。

利用该漏洞，可以上传任意jsp文件，进而获取服务器权限。

<!--more-->

#### 复现过程

1. 访问http://your-ip:7001/console，进入登录界面

2. 查看密码

   `sudo docker-composer logs`

   ![](http://cdn.laohuan.art/2020-07-02_16-42-00.png)

3. 登录后台页面，点击`base_domain`的配置，在“高级”中开启“启用 Web 服务测试页”选项

4. 访问`http://your-ip:7001/ws_utc/config.do`，设置Work Home Dir为如下路径

   `/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css`

5. 然后点击安全 -> 增加，然后上传webshell,这里使用了冰蝎的jsp马。

   ![](http://cdn.laohuan.art/2020-07-02_16-58-03.png)

6. 使用bp抓包，查看返回的时间戳

   ![](http://cdn.laohuan.art/2020-07-02_17-00-23.png)

7. 然后访问`http://your-ip:7001/ws_utc/css/config/keystore/[时间戳]_[文件名]`，即可执行webshell：

   ![](http://cdn.laohuan.art/2020-07-02_21-46-57.png)

#### 参考链接

<https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2018-2894/>